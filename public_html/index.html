<html>
    <head>
        <title>PACMAN</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    
    <body>
        
        <table id="table" cellpadding=4 border="0" style="width:50%;text-align:center;vertical-align:middle" style="align:center">
            
            <tr>
                <th> 0</th>
                <th> 1</th>
                <th> 2</th>
                <th> 3</th>
                <th> 4</th>
                <th> 5</th>
                <th> 6</th>
                <th> 7</th>
                <th> 8</th>
                <th> 9</th>
                <th>10</th>
                <th>11</th>
                <th>12</th>
                <th>13</th>
                <th>14</th>
                <th>15</th>
                <th>16</th>
                <th>17</th>
                <th>18</th>
                <th>19</th>
                <th>20</th>
                <th>21</th>
                <th>22</th>
                <th>23</th>
                <th>24</th>
                <th>25</th>
                <th>26</th>
                <th>27</th>
                <th>28</th>
                <th>29</th>
            </tr>
        </table>
        
        <script>
            
            var board = [];
            var ghost = [];
            //GHOSTS, VALUES: [row(1-28), column(1-28), direction(0-3)]
            ghost[0] = [0, 0, ""];
            ghost[1] = [0, 0, ""];
            ghost[2] = [0, 0, ""];
            //PLAYER, VALUES: [row(1-29), column(1-29), direction(0-3), teclat(0-3)]
            var player = [0, 0, 0, 0];
            
            
            board[0]=      [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
            board[1]=      [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1];
            board[2]=      [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[3]=      [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[4]=      [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[5]=      [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[6]=      [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1];
            board[7]=      [1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[8]=      [1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[9]=      [1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1];
            board[10]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[11]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[12]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[13]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[14]=     [1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1];
            board[15]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[16]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[17]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[18]=     [1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1];
            board[19]=     [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1];
            board[20]=     [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[21]=     [1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1];
            board[22]=     [1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1];
            board[23]=     [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1];
            board[24]=     [1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1];
            board[25]=     [1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1];
            board[26]=     [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1];
            board[27]=     [1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1];
            board[28]=     [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1];
            board[29]=     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
            
            
            function getRandomInt(min, max) {
              return Math.floor(Math.random() * (max - min)) + min;
            }
            
            var row_ghost = [];
            var column_ghost = [];
            var ghost = [];

            
            function generateGhosts() {
                var comptador = 0;
                    do {
                        var row = getRandomInt(0, 29);
                        var column = getRandomInt(0, 29);
                        var posicio_inicial = board[row][column];
                        if (posicio_inicial === 0) {
                            
                            board[row][column] = "F" + comptador;
                            
                            row_ghost.push(row);
                            column_ghost.push(column);
                            
                            document.write("GHOST " + (comptador) + " ACTUAL POSITION:: " + "ROW: " + row + " COLUMN: " + column + " VALUE: " + posicio_inicial);
                            document.write(" </br> ");
                            

                            comptador++;
                            
                        }
                    } while (comptador < 3) //creates 3 ghosts on valid positions
            }
            
            function generatePlayer() {
                player = 0;
                    do {
                        var row = getRandomInt(0, 29);
                        var column = getRandomInt(0, 29);
                        var posicio_inicial = board[row][column];
                        if (posicio_inicial === 0) {
                            player++;
                            board[row][column] = "JG";
                            
                            document.write("PLAYER " + (player) + " ACTUAL POSITION:: " + "ROW: " + row + " COLUMN: " + column + " VALUE: " + posicio_inicial);
                            document.write(" </br> ");
                        }
                    } while (player < 1) //creates one player
                
            }

            //This next function will need to set a new random valid direction in case the ghost can go straight anymore to it's actual set direction
            function checkGhostPosition() {
                //Check new next positions
                for (i = 0; i < row_ghost.length; i++) {
                    
                    var valid = [];

                    resta_fila = (row_ghost[i] - 1);
                    suma_fila = (row_ghost[i] + 1);
                    resta_columna = (column_ghost[i] - 1);
                    suma_columna = (column_ghost[i] + 1);
                    
                    var amunt = board[resta_fila][column_ghost[i]];
                    var avall = board[suma_fila][column_ghost[i]];
                    var esquerra = board[row_ghost[i]][resta_columna];
                    var dreta = board[row_ghost[i]][suma_columna];


                    if (amunt !== 1){
                        //It can go up ^
                        valid.push("up");
                    }
                   
                    if (avall !== 1){
                        //It can go down
                        valid.push("down");
                    }
                    
                    if (esquerra !== 1){
                        //It can go left <
                        valid.push("left");
                    }
                    
                    if (dreta !== 1){
                        //It can go right >
                        valid.push("right");
                    }
                    
                    //Once we checked the possible new valid positions, with the array direction we choose only ONE ELEMENT RANDOMLY
                    var direction = valid[Math.floor(Math.random() * valid.length)];
                    
                    rowValid = []; //Set a new array to save the next row valid position for each player
                    columnValid = []; //Set a new array to save the next column valid position for each player
                    
                    //ONLY ONE "direction" WILL BE SENDED BELOW, chosed randomly
                    
                    if (direction === "up") {
                        //up ^
                        var rowValid = (row_ghost[i] - 1);
                        var columnValid = column_ghost[i];
                    }
                    
                    if (direction === "down"){
                        //down v
                        rowValid = (row_ghost[i] + 1);
                        columnValid = column_ghost[i];
                    }
                    
                    if (direction === "left"){
                        //left <
                        rowValid = row_ghost[i];
                        columnValid = (column_ghost[i] - 1);
                    }
                    
                    if (direction === "right"){
                        //right >
                        rowValid = row_ghost[i];
                        columnValid = (column_ghost[i] + 1);
                    }
                    
                    ghost[i] = [row_ghost[i], column_ghost[i], direction];

                    document.write("NEXT POSITION OF GHOST:::: " + i + ":::: ROW " + rowValid + " - COLUMN " + columnValid + " (" + direction + ") ///" + "Array fantasme: " + ghost[i]);
                    document.write("/// Next valid positions taken from this gost were: " + valid + ")"); //As you can see it pushes all positions as valid
                    document.write("</br>");
                    valid = []; //We empty the array for future checkings
                }
            }
            

            generateGhosts(); //Generate 3 ghosts on valid positions.
            generatePlayer(); //Generate one player on a valid position.


            document.write("</br>");
            document.write("FUTURE CHECKED PATHS:");
            document.write("</br></br>");
            
            checkGhostPosition();

            for (i = 0; i <ghost.length; i++) {
                document.write("Valors actuals del fantasma " + i + " son: " + ghost[i]);
                document.write("</br>");
            }
            
            //==============PRINT TABLE HTML==============//
            table = document.getElementById("table");
            for(var i = 0; i < board.length; i++)
            {
               // create a new row
               var newRow = table.insertRow(table.length);
               for(var j = 0; j < board[i].length; j++)
               {
                   // create a new cell
                   var cell = newRow.insertCell(j);
                   
                   // add value to the cell
                   cell.innerHTML = board[i][j];
               }
           }
            //==============TABLE PRINTED==============//
        
        </script>
</html>